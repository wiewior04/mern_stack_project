{"ast":null,"code":"import _regeneratorRuntime from\"/Users/akaczmarek/Desktop/usi-project/mern_stack_project/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/akaczmarek/Desktop/usi-project/mern_stack_project/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/akaczmarek/Desktop/usi-project/mern_stack_project/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{Navigate,useParams}from\"react-router-dom\";import Editor from\"../Editor\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function EditPost(){var _useParams=useParams(),id=_useParams.id;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),title=_useState2[0],setTitle=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),summary=_useState4[0],setSummary=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),content=_useState6[0],setContent=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),files=_useState8[0],setFiles=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),redirect=_useState10[0],setRedirect=_useState10[1];useEffect(function(){fetch('http://localhost:4000/post/'+id).then(function(response){response.json().then(function(postInfo){setTitle(postInfo.title);setContent(postInfo.content);setSummary(postInfo.summary);});});},[]);function updatePost(_x){return _updatePost.apply(this,arguments);}function _updatePost(){_updatePost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(ev){var data,response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:ev.preventDefault();data=new FormData();data.set('title',title);data.set('summary',summary);data.set('content',content);data.set('id',id);if(files!==null&&files!==void 0&&files[0]){data.set('file',files===null||files===void 0?void 0:files[0]);}_context.next=9;return fetch('http://localhost:4000/post',{method:'PUT',body:data,credentials:'include'});case 9:response=_context.sent;if(response.ok){setRedirect(true);}case 11:case\"end\":return _context.stop();}},_callee);}));return _updatePost.apply(this,arguments);}if(redirect){return/*#__PURE__*/_jsx(Navigate,{to:'/post/'+id});}return/*#__PURE__*/_jsxs(\"form\",{onSubmit:updatePost,children:[/*#__PURE__*/_jsx(\"input\",{type:\"title\",placeholder:'Title',value:title,onChange:function onChange(ev){return setTitle(ev.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"summary\",placeholder:'Summary',value:summary,onChange:function onChange(ev){return setSummary(ev.target.value);}}),/*#__PURE__*/_jsx(\"input\",{type:\"file\",onChange:function onChange(ev){return setFiles(ev.target.files);}}),/*#__PURE__*/_jsx(Editor,{onChange:setContent,value:content}),/*#__PURE__*/_jsx(\"button\",{style:{marginTop:'5px'},children:\"Update post\"})]});}","map":{"version":3,"names":["useEffect","useState","Navigate","useParams","Editor","jsx","_jsx","jsxs","_jsxs","EditPost","_useParams","id","_useState","_useState2","_slicedToArray","title","setTitle","_useState3","_useState4","summary","setSummary","_useState5","_useState6","content","setContent","_useState7","_useState8","files","setFiles","_useState9","_useState10","redirect","setRedirect","fetch","then","response","json","postInfo","updatePost","_x","_updatePost","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee","ev","data","wrap","_callee$","_context","prev","next","preventDefault","FormData","set","method","body","credentials","sent","ok","stop","to","onSubmit","children","type","placeholder","value","onChange","target","style","marginTop"],"sources":["/Users/akaczmarek/Desktop/usi-project/mern_stack_project/client/src/pages/EditPost.js"],"sourcesContent":["import {useEffect, useState} from \"react\";\nimport {Navigate, useParams} from \"react-router-dom\";\nimport Editor from \"../Editor\";\n\nexport default function EditPost() {\n  const {id} = useParams();\n  const [title,setTitle] = useState('');\n  const [summary,setSummary] = useState('');\n  const [content,setContent] = useState('');\n  const [files, setFiles] = useState('');\n  const [redirect,setRedirect] = useState(false);\n\n  useEffect(() => {\n    fetch('http://localhost:4000/post/'+id)\n      .then(response => {\n        response.json().then(postInfo => {\n          setTitle(postInfo.title);\n          setContent(postInfo.content);\n          setSummary(postInfo.summary);\n        });\n      });\n  }, []);\n\n  async function updatePost(ev) {\n    ev.preventDefault();\n    const data = new FormData();\n    data.set('title', title);\n    data.set('summary', summary);\n    data.set('content', content);\n    data.set('id', id);\n    if (files?.[0]) {\n      data.set('file', files?.[0]);\n    }\n    const response = await fetch('http://localhost:4000/post', {\n      method: 'PUT',\n      body: data,\n      credentials: 'include',\n    });\n    if (response.ok) {\n      setRedirect(true);\n    }\n  }\n\n  if (redirect) {\n    return <Navigate to={'/post/'+id} />\n  }\n\n  return (\n    <form onSubmit={updatePost}>\n      <input type=\"title\"\n             placeholder={'Title'}\n             value={title}\n             onChange={ev => setTitle(ev.target.value)} />\n      <input type=\"summary\"\n             placeholder={'Summary'}\n             value={summary}\n             onChange={ev => setSummary(ev.target.value)} />\n      <input type=\"file\"\n             onChange={ev => setFiles(ev.target.files)} />\n      <Editor onChange={setContent} value={content} />\n      <button style={{marginTop:'5px'}}>Update post</button>\n    </form>\n  );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}